# VCampus ç®¡ç†å‘˜å¼€å‘æŒ‡å—

## ðŸ“‹ ç®¡ç†å‘˜æ¦‚è¿°

ç®¡ç†å‘˜æ˜¯VCampusç³»ç»Ÿä¸­çš„é«˜çº§ç”¨æˆ·ï¼Œè´Ÿè´£ä¸åŒæ¨¡å—çš„ç®¡ç†å’Œç»´æŠ¤å·¥ä½œã€‚

## ðŸ” ç®¡ç†å‘˜è§’è‰²å®šä¹‰

æ ¹æ® `Role.java`æžšä¸¾å’Œ `AdminViewController.java`çš„å®žçŽ°ï¼Œç³»ç»Ÿå®šä¹‰äº†ä»¥ä¸‹ç®¡ç†å‘˜è§’è‰²ï¼š

### è§’è‰²ç¼–ç ä¸Žå¯¹åº”ç•Œé¢

- **ç”¨æˆ·ç®¡ç†å‘˜ (3)**: ç”¨æˆ·IDä»¥ `3` å¼€å¤´ â†’ `/fxml/admin/UserAdminView.fxml`
- **å­¦ç±ç®¡ç†å‘˜ (4)**: ç”¨æˆ·IDä»¥ `4` å¼€å¤´ â†’ `/fxml/admin/StudentAdminView.fxml`
- **æ•™åŠ¡ç®¡ç†å‘˜ (5)**: ç”¨æˆ·IDä»¥ `5` å¼€å¤´ â†’ `/fxml/admin/CourseAdminView.fxml`
- **å›¾ä¹¦é¦†ç®¡ç†å‘˜ (6)**: ç”¨æˆ·IDä»¥ `6` å¼€å¤´ â†’ `/fxml/admin/LibraryAdminView.fxml`
- **å•†åº—ç®¡ç†å‘˜ (7)**: ç”¨æˆ·IDä»¥ `7` å¼€å¤´ â†’ `/fxml/admin/ShopAdminView.fxml`

## ðŸš€ ç®¡ç†å‘˜æ³¨å†Œæ–¹å¼ï¼ˆè¯·åœ¨databaseçš„dbæ–‡ä»¶å¤¹ä¸‹çš„user.csvæ–‡ä»¶æŸ¥çœ‹è‡ªå·±çš„ä¿¡æ¯ï¼Œæˆ‘å·²ç»ç»™ä½ ä»¬è®¾ç½®å¥½äº†ï¼‰

### 1. æ•°æ®åº“ç›´æŽ¥æ³¨å†Œ

åœ¨æ•°æ®åº“åˆå§‹åŒ–æ—¶è‡ªåŠ¨åˆ›å»ºï¼šï¼ˆæ‰€æœ‰ç®¡ç†å‘˜å·²ç»åˆ›å»ºå¥½äº†ï¼‰

```sql
-- é»˜è®¤ç®¡ç†å‘˜è´¦æˆ·
INSERT INTO vcampus_db.tb_user (userId, password) VALUES
('3456789', '9876543');  -- ç”¨æˆ·ç®¡ç†å‘˜
```

### 2. é€šè¿‡çŽ°æœ‰ç®¡ç†å‘˜æ³¨å†Œ

1. ä½¿ç”¨çŽ°æœ‰ç”¨æˆ·ç®¡ç†å‘˜è´¦æˆ·ç™»å½•
2. è¿›å…¥"ç”¨æˆ·ç®¡ç†" â†’ "åˆ›å»ºç”¨æˆ·"
3. å¡«å†™æ–°ç®¡ç†å‘˜ä¿¡æ¯ï¼š
   - ç”¨æˆ·ID: `3xxxxxx` åˆ° `7xxxxxx`
   - å¯†ç : è®¾ç½®å®‰å…¨å¯†ç 
4. ç‚¹å‡»"åˆ›å»ºç”¨æˆ·"

### 3. æ‰‹åŠ¨æ•°æ®åº“æ³¨å†Œ

ç›´æŽ¥åœ¨MySQLä¸­æ‰§è¡Œï¼š

```sql
-- åˆ›å»ºæ–°ç®¡ç†å‘˜
INSERT INTO vcampus_db.tb_user (userId, password) VALUES
('3000001', 'admin123'),  -- ç”¨æˆ·ç®¡ç†å‘˜
('4000002', 'student456'),  -- å­¦ç±ç®¡ç†å‘˜
('5000003', 'course789');  -- æ•™åŠ¡ç®¡ç†å‘˜
```

## ðŸ  ç®¡ç†å‘˜ç™»å½•æµç¨‹

## âš ï¸ å¼€å‘æ³¨æ„äº‹é¡¹

### 1. è§’è‰²éªŒè¯ï¼ˆåŸºäºŽRole.javaï¼‰

```java
// ä½¿ç”¨Roleæžšä¸¾éªŒè¯ç®¡ç†å‘˜è§’è‰²
public boolean isAdmin(String userId) {
    try {
        Role role = Role.fromUserId(userId);
        return role.getCode() >= 3; // 3-7éƒ½æ˜¯ç®¡ç†å‘˜
    } catch (IllegalArgumentException e) {
        return false;
    }
}

// èŽ·å–ç®¡ç†å‘˜ç±»åž‹
public Role getAdminRole(String userId) {
    try {
        return Role.fromUserId(userId);
    } catch (IllegalArgumentException e) {
        return null;
    }
}
```

### 2. ç•Œé¢åŠ è½½é€»è¾‘ï¼ˆåŸºäºŽAdminViewController.javaï¼‰ï¼Œè¿™ä¸ªæ–‡ä»¶åœ¨å®¢æˆ·ç«¯çš„controlleré‡Œ

```java
// æ ¹æ®ç”¨æˆ·è§’è‰²åŠ è½½ç›¸åº”çš„ç®¡ç†å‘˜å†…å®¹
private void loadAdminContent() {
    UserSession userSession = MainApp.getGlobalUserSession();
    if (userSession.isLoggedIn()) {
        String userId = userSession.getCurrentUserId();
        String firstChar = userId.substring(0, 1);
  
        String contentPath;
        switch (firstChar) {
            case "3": // ç”¨æˆ·ç®¡ç†å‘˜
                contentPath = "/fxml/admin/UserAdminView.fxml";
                break;
            case "4": // å­¦ç±ç®¡ç†å‘˜
                contentPath = "/fxml/admin/StudentAdminView.fxml";
                break;
            case "5": // æ•™åŠ¡ç®¡ç†å‘˜
                contentPath = "/fxml/admin/CourseAdminView.fxml";
                break;
            case "6": // å›¾ä¹¦é¦†ç®¡ç†å‘˜
                contentPath = "/fxml/admin/LibraryAdminView.fxml";
                break;
            case "7": // å•†åº—ç®¡ç†å‘˜
                contentPath = "/fxml/admin/ShopAdminView.fxml";
                break;
            default: // é»˜è®¤ç®¡ç†å‘˜
                contentPath = "/fxml/admin/UserAdminView.fxml";
                break;
        }
  
        loadView(contentPath);
    }
}
```

### 3. ç”¨æˆ·IDéªŒè¯

```java
// éªŒè¯ç®¡ç†å‘˜IDæ ¼å¼
public boolean validateAdminId(String userId) {
    if (userId == null || userId.length() != 7) {
        return false;
    }
  
    // æ£€æŸ¥æ˜¯å¦ä¸ºçº¯æ•°å­—
    if (!userId.matches("\\d{7}")) {
        return false;
    }
  
    // æ£€æŸ¥é¦–ä½æ˜¯å¦ä¸º3-7ï¼ˆç®¡ç†å‘˜èŒƒå›´ï¼‰
    char firstChar = userId.charAt(0);
    return firstChar >= '3' && firstChar <= '7';
}
```
