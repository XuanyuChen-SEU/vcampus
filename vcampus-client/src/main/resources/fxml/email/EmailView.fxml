<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>
<?import java.net.URL?>

<BorderPane fx:id="rootPane" prefHeight="600.0" prefWidth="1000.0" styleClass="email-background"
            xmlns="http://javafx.com/javafx/8" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.vcampus.client.controller.EmailController">
    <stylesheets>
        <URL value="@../../css/EmailView.css" />
    </stylesheets>

    <!-- 顶部工具栏 -->
    <top>
        <HBox alignment="CENTER_LEFT" prefHeight="60.0" spacing="15.0" styleClass="email-toolbar">
            <padding>
                <Insets bottom="10.0" left="20.0" right="20.0" top="10.0" />
            </padding>
            <children>
                <!-- 邮件系统标题 -->
                <Label text="📧 邮件系统" styleClass="email-title">
                    <font>
                        <Font name="System Bold" size="20.0" />
                    </font>
                </Label>

                <!-- 搜索框 -->
                <TextField fx:id="searchField" onAction="#handleSearch" promptText="按主题搜索邮件..." 
                          styleClass="email-search-field" HBox.hgrow="ALWAYS" />

                <!-- 分隔符 -->
                <Region HBox.hgrow="ALWAYS" />

                <!-- 操作按钮 -->
                <Button fx:id="composeButton" onAction="#handleComposeEmail" text="✏️ 写邮件" 
                        styleClass="email-action-button" />
                <Button fx:id="refreshButton" onAction="#handleRefresh" text="🔄 刷新" 
                        styleClass="email-action-button" />
            </children>
        </HBox>
    </top>

    <!-- 主要内容区域 -->
    <center>
        <SplitPane fx:id="mainSplitPane" dividerPositions="0.3" styleClass="email-split-pane">
            
            <!-- 左侧：邮件列表区域 -->
            <items>
                <VBox fx:id="emailListContainer" prefWidth="300.0" styleClass="email-list-container">
                    
                    <!-- 邮件分类标签页 -->
                    <HBox alignment="CENTER_LEFT" spacing="0.0" styleClass="email-tabs">
                        <children>
                            <Button fx:id="inboxTab" onAction="#handleInboxTab" text="📥 收件箱" 
                                    styleClass="email-tab-button, email-tab-active" />
                            <Button fx:id="sentTab" onAction="#handleSentTab" text="📤 发件箱" 
                                    styleClass="email-tab-button" />
                            <Button fx:id="draftTab" onAction="#handleDraftTab" text="📝 草稿箱" 
                                    styleClass="email-tab-button" />
                        </children>
                    </HBox>

                    <!-- 邮件列表 -->
                    <TableView fx:id="emailTable" styleClass="email-table">
                        <columns>
                            <TableColumn fx:id="senderColumn" prefWidth="25.0" text="发件人" />
                            <TableColumn fx:id="subjectColumn" prefWidth="45.0" text="主题" />
                            <TableColumn fx:id="timeColumn" prefWidth="20.0" text="时间" />
                            <TableColumn fx:id="statusColumn" prefWidth="10.0" text="状态" />
                        </columns>
                        <columnResizePolicy>
                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                        </columnResizePolicy>
                    </TableView>

                    <!-- 分页控制 -->
                    <HBox alignment="CENTER" spacing="10.0" styleClass="email-pagination">
                        <children>
                            <Button fx:id="prevPageButton" onAction="#handlePrevPage" text="◀ 上一页" 
                                    styleClass="email-page-button" />
                            <Label fx:id="pageInfoLabel" text="第 1 页" styleClass="email-page-info" />
                            <Button fx:id="nextPageButton" onAction="#handleNextPage" text="下一页 ▶" 
                                    styleClass="email-page-button" />
                        </children>
                    </HBox>
                </VBox>

                <!-- 右侧：邮件详情区域 -->
                <VBox fx:id="emailDetailContainer" prefWidth="700.0" styleClass="email-detail-container">
                    
                    <!-- 邮件详情头部 -->
                    <HBox alignment="CENTER_LEFT" spacing="10.0" styleClass="email-detail-header">
                        <padding>
                            <Insets bottom="10.0" left="15.0" right="15.0" top="10.0" />
                        </padding>
                        <children>
                            <Label fx:id="detailSubjectLabel" text="请选择一封邮件查看详情" 
                                   styleClass="email-detail-subject" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Button fx:id="markReadButton" onAction="#handleMarkAsRead" text="✓ 标记已读" 
                                    styleClass="email-detail-button" visible="false" />
                            <Button fx:id="markUnreadButton" onAction="#handleMarkAsUnread" text="✗ 标记未读" 
                                    styleClass="email-detail-button" visible="false" />
                            <Button fx:id="continueComposeButton" onAction="#handleContinueCompose" text="✏️ 继续编写" 
                                    styleClass="email-detail-button" visible="false" />
                            <Button fx:id="deleteButton" onAction="#handleDeleteEmail" text="🗑️ 删除" 
                                    styleClass="email-detail-button, email-delete-button" visible="false" />
                            <Button fx:id="replyButton" onAction="#handleReplyEmail" text="↩️ 回复" 
                                    styleClass="email-detail-button" visible="false" />
                        </children>
                    </HBox>

                    <!-- 邮件详情内容 -->
                    <ScrollPane fx:id="emailDetailScrollPane" fitToWidth="true" styleClass="email-detail-scroll">
                        <content>
                            <VBox fx:id="emailDetailContent" spacing="10.0" styleClass="email-detail-content">
                                <padding>
                                    <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                                </padding>
                                <children>
                                    <!-- 邮件基本信息 -->
                                    <HBox alignment="CENTER_LEFT" spacing="20.0" styleClass="email-info-row">
                                        <children>
                                            <Label text="发件人:" styleClass="email-info-label" />
                                            <Label fx:id="detailSenderLabel" text="" styleClass="email-info-value" />
                                        </children>
                                    </HBox>
                                    <HBox alignment="CENTER_LEFT" spacing="20.0" styleClass="email-info-row">
                                        <children>
                                            <Label text="收件人:" styleClass="email-info-label" />
                                            <Label fx:id="detailRecipientLabel" text="" styleClass="email-info-value" />
                                        </children>
                                    </HBox>
                                    <HBox alignment="CENTER_LEFT" spacing="20.0" styleClass="email-info-row">
                                        <children>
                                            <Label text="发送时间:" styleClass="email-info-label" />
                                            <Label fx:id="detailTimeLabel" text="" styleClass="email-info-value" />
                                        </children>
                                    </HBox>
                                    <HBox alignment="CENTER_LEFT" spacing="20.0" styleClass="email-info-row">
                                        <children>
                                            <Label text="状态:" styleClass="email-info-label" />
                                            <Label fx:id="detailStatusLabel" text="" styleClass="email-info-value" />
                                        </children>
                                    </HBox>

                                    <!-- 分隔线 -->
                                    <Region prefHeight="10.0" />

                                    <!-- 邮件内容 -->
                                    <Label text="邮件内容:" styleClass="email-content-label" />
                                    <ScrollPane fx:id="emailContentScrollPane" fitToWidth="true" 
                                               prefHeight="300.0" styleClass="email-content-scroll">
                                        <content>
                                            <Label fx:id="detailContentLabel" text="" 
                                                   styleClass="email-content-text" wrapText="true" />
                                        </content>
                                    </ScrollPane>
                                </children>
                            </VBox>
                        </content>
                    </ScrollPane>
                </VBox>
            </items>
        </SplitPane>
    </center>

    <!-- 底部状态栏 -->
    <bottom>
        <HBox alignment="CENTER_LEFT" prefHeight="30.0" styleClass="email-status-bar">
            <padding>
                <Insets bottom="5.0" left="20.0" right="20.0" top="5.0" />
            </padding>
            <children>
                <Region HBox.hgrow="ALWAYS" />
                <Label fx:id="unreadCountLabel" text="未读邮件: 0" styleClass="email-unread-count" />
            </children>
        </HBox>
    </bottom>
</BorderPane>